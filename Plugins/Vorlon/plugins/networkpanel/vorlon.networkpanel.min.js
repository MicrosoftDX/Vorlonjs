var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);n.prototype=e.prototype,t.prototype=new n},VORLON;!function(t){var e=function(e){function s(){e.call(this,"networkpanel","control.html","control.css"),this._id="NETWORKPANEL",this._ready=!1}return __extends(s,e),s.prototype.refresh=function(){},s.prototype.startClientSide=function(){this.setupXMLHttpRequestHook(!0)},s.prototype.onRealtimeMessageReceivedFromDashboardSide=function(){},s.prototype.setupXMLHttpRequestHook=function(){var e=this,n=window;n.___XMLHttpRequest=n.XMLHttpRequest;var s=function(){var s=new n.___XMLHttpRequest,r={id:t.Tools.CreateGUID(),url:null,status:null,statusText:null,method:null,responseType:null,readyState:0};return s.__open=s.open,s.open=function(){return r.method=arguments[0],r.url=arguments[1],e.trace("request for "+r.url),e.sendToDashboard({type:"xhr",message:r}),s.__open.apply(s,arguments)},s.addEventListener("readystatechange",function(){r.readyState=s.readyState,e.trace("STATE CHANGED "+r.readyState),4===r.readyState&&(r.responseType=s.responseType,r.status=s.status,r.statusText=s.statusText,e.trace("LOADED !!!")),e.sendToDashboard({type:"xhr",message:r})}),s};n.XMLHttpRequest=s},s.prototype._render=function(t,e,n,s){var r=document.createElement(t);return r.className=n||"",s&&(r.innerHTML=s),e.appendChild(r),r},s.prototype._mapAction=function(t,e){var n=this._dashboardDiv.querySelector(t);return n.addEventListener("click",function(){return e(n)}),n},s.prototype.startDashboardSide=function(t){var e=this;void 0===t&&(t=null),this._dashboardDiv=t,this._items={},this._insertHtmlContentAsync(t,function(t){e._itemsContainer=t.querySelector(".network-items"),e._clearButton=t.querySelector('x-action[event="clear"]'),e._clearButton.addEventListener("click",function(){e.sendToClient({type:"clear"}),e._itemsContainer.innerHTML="",e._items={}}),e._ready=!0})},s.prototype.onRealtimeMessageReceivedFromClientSide=function(t){if("xhr"===t.type){var e=t.message;this.processNetworkItem(e)}this.trace(t.message)},s.prototype.processNetworkItem=function(t){var e=this._items[t.id];e||(e=new n(this._itemsContainer,t),this._items[t.id]=e),e.update(t)},s}(Plugin);t.NetworkPanel=e;var n=function(){function e(e,n){var s=this;this.item=n,this.element=new t.FluentDOM("DIV","network-item").append("DIV","description",function(t){t.append("DIV","status item smallitem",function(t){s.statusElt=t.element,t.html('<i class="fa fa-spin fa-spinner"></i>')}).append("DIV","method item smallitem",function(t){t.text(n.method.toUpperCase())}).append("DIV","url item",function(t){t.text(n.url)})}).append("DIV","details",function(t){t.append("DIV","responsetype",function(t){s.responseTypeElt=t.element,t.html("&nbsp;")})}).element,e.appendChild(this.element)}return e.prototype.update=function(t){this.item=t,4===t.readyState&&(200!==t.status&&this.element.classList.add("error"),this.statusElt.innerText=t.status.toString(),this.responseTypeElt.innerText="response type : "+(t.responseType||"text"))},e}();Core.RegisterPlugin(new e)}(VORLON||(VORLON={}));