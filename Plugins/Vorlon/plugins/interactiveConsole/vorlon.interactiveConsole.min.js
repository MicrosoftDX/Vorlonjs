var __extends=this.__extends||function(e,o){function n(){this.constructor=e}for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);n.prototype=o.prototype,e.prototype=new n},VORLON;!function(VORLON){var InteractiveConsole=function(_super){function InteractiveConsole(){_super.call(this,"interactiveConsole","control.html","control.css"),this._cache=[],this._commandHistory=[],this._ready=!1,this._id="CONSOLE"}return __extends(InteractiveConsole,_super),InteractiveConsole.prototype.startClientSide=function(){var e=this;VORLON.Tools.Hook(window.console,"clear",function(){var o={type:"clear"};e.sendToDashboard(o,!0),e._cache.push(o)}),VORLON.Tools.Hook(window.console,"log",function(o){var n={message:o,type:"log"};e.sendToDashboard(n,!0),e._cache.push(n)}),VORLON.Tools.Hook(window.console,"debug",function(o){var n={message:o,type:"debug"};e.sendToDashboard(n,!0),e._cache.push(n)}),VORLON.Tools.Hook(window.console,"info",function(o){var n={message:o,type:"info"};e.sendToDashboard(n,!0),e._cache.push(n)}),VORLON.Tools.Hook(window.console,"warn",function(o){var n={message:o,type:"warn"};e.sendToDashboard(n,!0),e._cache.push(n)}),VORLON.Tools.Hook(window.console,"error",function(o){var n={message:o,type:"error"};e.sendToDashboard(n,!0),e._cache.push(n)});var o=Error;Error=function(n){var t=new o(n),s={message:n,type:"exception"};return e.sendToDashboard(s,!0),e._cache.push(s),t}},InteractiveConsole.prototype.onRealtimeMessageReceivedFromDashboardSide=function(receivedObject){switch(receivedObject.type){case"eval":try{eval(receivedObject.order)}catch(e){console.error("Unable to execute order: "+e.message)}}},InteractiveConsole.prototype.refresh=function(){this.sendToDashboard({type:"clear"});for(var e=0;e<this._cache.length;e++)this.sendToDashboard(this._cache[e],!0)},InteractiveConsole.prototype.startDashboardSide=function(e){var o=this;void 0===e&&(e=null),this._insertHtmlContentAsync(e,function(n){o._containerDiv=VORLON.Tools.QuerySelectorById(n,"logs"),o._interactiveInput=VORLON.Tools.QuerySelectorById(e,"input"),o._interactiveInput.addEventListener("keydown",function(e){13===e.keyCode&&(o.sendToClient({order:o._interactiveInput.value,type:"eval"}),o._commandHistory.push(o._interactiveInput.value),o._commandIndex=null,o._interactiveInput.value=""),38===e.keyCode?(null==o._commandIndex&&(o._commandIndex=o._commandHistory.length),o._commandHistory.length>0&&o._commandIndex>0&&(o._commandIndex--,o._interactiveInput.value=o._commandHistory[o._commandIndex])):40===e.keyCode&&o._commandHistory.length>0&&null!=o._commandIndex&&(o._commandIndex<o._commandHistory.length-1?(o._commandIndex++,o._interactiveInput.value=o._commandHistory[o._commandIndex]):(o._interactiveInput.value="",o._commandIndex=null))}),o._ready=!0})},InteractiveConsole.prototype.onRealtimeMessageReceivedFromClientSide=function(e){if("clear"!==e.type){var o=document.createElement("div");switch(VORLON.Tools.AddClass(o,"log"),e.type){case"log":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logMessage");break;case"debug":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logDebug");break;case"info":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logInfo");break;case"warn":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logWarning");break;case"error":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logError");break;case"exception":o.innerHTML=e.message,VORLON.Tools.AddClass(o,"logException");break;case"order":return this._interactiveInput.value='document.getElementById("'+e.order+'")',void 0}this._containerDiv.insertBefore(o,this._containerDiv.childNodes.length>0?this._containerDiv.childNodes[0]:null)}else for(;this._containerDiv.hasChildNodes();)this._containerDiv.removeChild(this._containerDiv.lastChild)},InteractiveConsole}(VORLON.Plugin);VORLON.InteractiveConsole=InteractiveConsole,VORLON.Core.RegisterPlugin(new InteractiveConsole)}(VORLON||(VORLON={}));