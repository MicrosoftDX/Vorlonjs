var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},VORLON;!function(t){var e=function(t){function e(){t.call(this,"nodejs","control.html",["control.css","tree.css"],"chart.js"),this._ready=!0,this.__MEGA_BYTE=1048576,console.log("Started")}return __extends(e,t),e.prototype.getID=function(){return"NODEJS"},e.prototype.startDashboardSide=function(t){var e=this;void 0===t&&(t=null),this._insertHtmlContentAsync(t,function(){e.toogleMenu(),e._time=0,e._ctx=document.getElementById("memory-chart"),e._ctx=e._ctx.getContext("2d"),e._chart_data={labels:[],datasets:[{label:"Heap Used (MB)",fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]},{label:"Heap Total (MB)",fill:!1,lineTension:.1,backgroundColor:"rgba(142, 68, 173,0.4)",borderColor:"rgba(142, 68, 173,1.0)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(142, 68, 173,1.0)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(142, 68, 173,1.0)",pointHoverBorderColor:"rgba(155, 89, 182,1.0)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]},{label:"RSS (MB)",fill:!1,lineTension:.1,backgroundColor:"rgba(192, 57, 43,0.4)",borderColor:"rgba(192, 57, 43,1.0)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(192, 57, 43,1.0)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(192, 57, 43,1.0)",pointHoverBorderColor:"rgba(231, 76, 60,1.0)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]}]},e._chart=!1,e.__html=[],e.sendToClient("infos"),e.sendToClient("memory"),e.sendToClient("modules")})},e.prototype.chart=function(){Chart.defaults.global.responsive=!0,Chart.defaults.global.maintainAspectRatio=!1,Chart.defaults.global.animation.easing="linear",this._chart=new Chart.Line(this._ctx,{data:this._chart_data})},e.prototype.jstree=function(){$(".tree li").each(function(){$(this).find("ul").children("li").length>0&&$(this).addClass("parent")}),$(".tree li.parent > a").click(function(){$(this).parent().toggleClass("active"),$(this).parent().children("ul").slideToggle("fast")})},e.prototype.toogleMenu=function(){$(".plugin-nodejs .open-menu").click(function(){$(".plugin-nodejs .open-menu").removeClass("active-menu"),$(".plugin-nodejs #searchlist").val(""),$(".plugin-nodejs .explorer-menu").hide(),$(".plugin-nodejs #"+$(this).data("menu")).show(),$(".plugin-nodejs .new-entry").fadeOut(),$(this).addClass("active-menu")})},e.prototype.renderTree=function(t){var e=this;e.__html.push("<ul>"),$.each(t,function(t,r){e.__html.push("<li><a>"+r.text+"</a>"),r.children&&e.renderTree(r.children),e.__html.push("</li>")}),e.__html.push("</ul>")},e.prototype.buildTree=function(t,e){if(0!==t.length){for(var r=0;r<e.length;r++)if(t[0]==e[r].text)return this.buildTree(t.splice(1,t.length),e[r].children),void 0;var o={text:t[0],children:[]};e.push(o),this.buildTree(t.splice(1,t.length),o.children)}},e.prototype.onRealtimeMessageReceivedFromClientSide=function(t){if("modules"==t.type){for(var e=t.data,r=[],o=0;o<e.length;o++){e[o]=e[o].split("\\");for(var a=0;a<e[o].length;a++)if("node_modules"==e[o][a]){e[o].splice(0,a);break}this.buildTree(e[o],r)}this.renderTree(r),$("#jstree").append(this.__html.join("")),this.jstree()}if("infos"==t.type){for(var i in t.data)$(".infos-"+i).append(t.data[i]);var n="";switch(t.data.platform){case"linux":n="linux.png";break;case"win32":n="windows.png";break;case"win64":n="windows.png";break;case"darwin":n="apple.png"}$(".infos-platform img").attr("src","/images/systems/"+n)}"memory"==t.type&&(this._chart||this.chart(),this._time>=70&&(this._chart.data.datasets[0].data.splice(0,1),this._chart.data.datasets[1].data.splice(0,1),this._chart.data.datasets[2].data.splice(0,1),this._chart.data.labels.splice(0,1)),this._chart.data.labels.push(this._time),this._chart.data.datasets[0].data.push(t.data.heapUsed/this.__MEGA_BYTE),this._chart.data.datasets[1].data.push(t.data.heapTotal/this.__MEGA_BYTE),this._chart.data.datasets[2].data.push(t.data.rss/this.__MEGA_BYTE),this._chart.update(),this._time+=5)},e}(t.DashboardPlugin);t.NodejsDashboard=e,t.Core.RegisterDashboardPlugin(new e)}(VORLON||(VORLON={}));